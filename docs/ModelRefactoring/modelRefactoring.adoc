== Concept Refactoring Analysis

=== 1. Purpose
This document analyzes how the conceptual model of the Hand Me Down domain evolved from Milestone 1 to Milestone 2. It identifies the main refactorings applied to entities, events, and terminology to make the model more aligned with observed behavior in the resale environment near UPRM. Each change is described with its rationale and impact on future requirements, architecture, and testing.

=== 2. Major Conceptual Refactorings

==== 2.1 Actor Entities — From Donator/Collector → Seller/Buyer
*Change Summary:*  
Milestone 1 used *Donator* and *Collector* to describe the two primary roles in exchanges. Milestone 2 replaces them with *Seller* and *Buyer* to reflect the behavior of users engaging in low-cost resale rather than donation.

*Rationale:*  
Field observations and stakeholder notes revealed that most exchanges among students involved symbolic resale prices (USD $8–$15), negotiation, and mutual benefit rather than one-way giving. Aligning terminology with *Seller* and *Buyer* clarifies responsibilities and supports trust-based features such as ratings and reviews.

*Impact:*  
- Removes ambiguity between donation and resale flows.  
- Establishes clearer mappings for requirements and user stories involving offers, reviews, and messaging.  
- Simplifies transitions into the listing-based lifecycle introduced in Milestone 2.

==== 2.2 Core Entity — Piece (Retained, Context Expanded)
*Change Summary:*  
The *Piece* remains the core domain entity but gains new context in Milestone 2 as the anchor for listings, ratings, and reviews.

*Rationale:*  
Milestone 1 defined Piece as a physical garment. Milestone 2 keeps this but attaches new representations: Listings, ConditionRating, Review, and Reservation. The Piece becomes the aggregate root that all these elements relate to.

*Impact:*  
- Provides stable identity for condition updates, reviews, and status changes.  
- Enables reuse of the same garment across multiple listings.  
- Connects physical reality (garment) to digital representation (listing).

==== 2.3 Event Refactoring — From Donation/Collection → Listing Lifecycle
*Change Summary:*  
Milestone 1’s actions (`donate`, `collect`, `discard`) are replaced in Milestone 2 with Listing lifecycle events (`publishListing`, `expressInterest`, `closeListing`, `discard`).

*Rationale:*  
The change shifts focus from physical handoff to digital visibility and user intent. Listings describe when a Piece becomes discoverable and when it exits visibility, regardless of where the real exchange happens.

*Impact:*  
- Makes visibility a measurable state change.  
- Allows analysis of listing durations and user interactions.  
- Better represents actual marketplace behaviors observed in WhatsApp and Facebook groups.

==== 2.4 Introduction of Listing as a System Representation
*Change Summary:*  
The *Listing* did not exist in Milestone 1. It is introduced in Milestone 2 as the published representation of a Piece.

*Rationale:*  
Milestone 1 merged the garment and the act of offering it. The new model separates them, allowing a Piece to exist independently and be listed multiple times. This mirrors real reuse cycles where users relist items if unsold or pass them to others.

*Impact:*  
- Adds a clean bridge between physical items and digital posts.  
- Supports publish/edit/close actions.  
- Enables analytics about active and closed listings.

==== 2.5 Behavioral Vocabulary Changes
*Change Summary:*  
Terms like *Exchange Flow* and *Student Resale Price Band* were replaced by *Discovery Flow* and *Informal Price Band* to generalize and modernize the vocabulary.

*Rationale:*  
These updates emphasize discovery and resale rather than charity. They maintain sociological grounding but make terms consistent with actual marketplace speech.

*Impact:*  
- Improves domain readability and traceability.  
- Makes AsciiDoc terminology align with student and community interviews.  
- Strengthens consistency across documentation and system design.

==== 2.6 Function Signature Updates
*Change Summary:*  
Milestone 1 functions:
----
donate(Piece, Donator, Locale) → DonationEvent
collect(Piece, Collector) → CollectionEvent
rate(Piece, ConditionRating) → ConditionRating
review(Collection, Review) → Review
----
Milestone 2 functions:
----
publishListing(Piece, Seller, Locale) → ListingPublished
expressInterest(Listing, Buyer) → InterestExpressed
closeListing(Listing) → ListingClosed
rate(Piece, ConditionRating) → ConditionRating
review(Seller, Buyer, Review) → ReviewSubmitted
----

*Rationale:*  
Functions now reflect a digital workflow with explicit actors and transitions, rather than implicit transfers of ownership.

*Impact:*  
- Introduces preconditions and postconditions for every operation.  
- Maps directly to potential API endpoints and automated tests.  
- Makes domain events observable and traceable.

==== 2.7 Expanded Domain Narrative
*Change Summary:*  
The story of donation and collection became a story of visibility, negotiation, and offline handoff.

*Rationale:*  
Students and families described flows similar to marketplace behavior rather than pure donation. Milestone 2 updates the narrative accordingly, emphasizing discovery and trust instead of charity.

*Impact:*  
- Aligns system behavior with real social practice.  
- Improves continuity with personas, epics, and UI prototypes.  
- Sets the basis for a trust-centric, transparency-driven platform story.

==== 2.8 Reframed Environmental and Social Context
*Change Summary:*  
Milestone 1 stressed poverty and waste reduction as its primary motivators. Milestone 2 integrates sustainability and affordability but frames the domain as *student-led circular resale* rather than aid or relief.

*Rationale:*  
This shift maintains social impact but situates the project in a more realistic, peer-to-peer context that can scale beyond charitable donation.

*Impact:*  
- Expands the range of target users (students, residents, informal sellers).  
- Makes outreach and validation more relevant to UPRM’s real social environment.  
- Strengthens long-term educational and sustainability goals.

=== 3. Structural and Traceability Improvements
Milestone 2 introduces clearer traceability between the descriptive and design parts of the documentation.

[cols="3,3,3", options="header"]
|===
| Aspect | Milestone 1 | Milestone 2

| Primary Actors
| Donator, Collector
| Seller, Buyer

| Core Object
| Piece
| Piece + Listing

| Event Model
| Donation, Collection
| Listing lifecycle (`Publish`, `Interest`, `Close`)

| Process
| Physical handoff
| Digital discovery + offline exchange

| Terminology
| Exchange Flow, Price Band
| Discovery Flow, Informal Price Band

| Functions
| Direct and static
| Stateful with explicit pre/postconditions

| Narrative
| Charity-oriented
| Marketplace-oriented

| Social Frame
| Aid and donation
| Circular resale and reuse
|=== 


=== 4. Conceptual Impact Summary
* The domain evolved from an object-transfer model to a visibility and negotiation model.  
* Events now represent state changes in the platform rather than physical exchanges.  
* Entities gained clearer roles and invariants: Piece as aggregate root, Listing as visibility artifact, Seller/Buyer as actors.  
* Vocabulary better matches stakeholder language and observed community behavior.  
* Traceability improved through explicit functions and life cycles tied to each aggregate.

=== 5. Conclusion
The refactoring from Milestone 1 to Milestone 2 transformed the project from a *charity-based donation model* into a *student-driven circular marketplace model*. By redefining actors, events, and behaviors, the domain now better represents how real exchanges occur in Mayagüez. This clarity strengthens the foundation for subsequent requirements, architecture, and testing work while preserving the project’s original social mission.
