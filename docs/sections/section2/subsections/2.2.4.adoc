=== *2.2.4 Interface Requirements*

==== Objective
[.changed]#Define how users interact with the system through visible UI elements, controls, states, and feedback. These *Interface Requirements* specify the behavior of forms, buttons, validation, navigation, and visibility rules. The platform facilitates listing and discovery but does not process payments or host transactions; all exchanges occur directly between buyers and sellers outside the system.#

==== [.changed]#Interface Requirements#

- [.removed]#**Clothing items** - represented as a unique system entity with attributes: item ID, seller ID, title, description, category, size, price, condition, and availability status.#

- [.removed]#**User account** - represented as a unique system entity with attributes: user ID, username, email, role (buyer, seller, or both), and transaction history.#

- [.removed]#**Transaction** - represented as a unique system entity with attributes: transaction ID, buyer ID, seller ID, item ID, status (pending, confirmed, completed), and timestamp.#


[.added]#*Create Listing Form*#
- [.added]#The authenticated user is implicitly the seller; **no seller field is displayed**.#  
- [.added]#Required fields: **Title**, **at least one Image**, and **Category**. Optional fields: **Price** (if absent, listing is marked **Free**), **Description**, **Condition**, and **Size**.#  
- [.added]#The **Publish** button is **disabled** until all required fields are valid.#  
- [.added]#On submit with missing or invalid fields, show **inline errors**; **focus moves** to the first invalid field.#  
- [.added]#On success, navigate to the **Listing Details** page and show a **toast**: “Listing published.”#

[.removed]#*Initialization Rules*#

- [.removed]#**Listing a clothing item** - the system shall initialize the item entity with all required attributes. An item cannot exist in the system without a valid seller ID and price.#

- [.removed]#**User registration** - when a new user registers, the system shall initialize a user entity with a unique user ID and default role “buyer.” Role changes to “seller” require additional verification (e.g., valid payment info).#

- [.removed]#**Purchase initiation** - when a buyer initiates a purchase, the system shall initialize a transaction entity with status = “pending” until confirmation.#

[.added]#*Listing Details (Seller View)*#
- [.added]#Shows editable fields (Title, Description, Images, Price, Condition) while **Status = Active**.#  
- [.added]#Includes a **Status** dropdown with transitions: **Active → Reserved → Closed** (no skipping).#  
- [.added]#When **Status = Closed**, all edit controls are **disabled**, and a **‘Closed’ badge** is displayed.#  
- [.added]#Displays **Contact Requests** received for that listing, sorted by most recent.#  

[.removed]#*Update Rules*#

- [.removed]#Item availability shall update automatically when a purchase is confirmed: availability status changes from “available” to “sold.”#

- [.removed]#Sellers may update item attributes (title, description, price). Updates to sold items are restricted.#

- [.removed]#Transaction status shall update in predefined steps: “pending” → “confirmed” → “completed.” Skipping states is not permitted.#

- [.removed]#User accounts may update certain attributes (email, profile details) but transaction history shall be immutable once recorded.#

[.added]#*Browse & Search (Buyer View)*#
- [.added]#Buyers can **search by keyword** and **filter by Category, Condition, Size, and Price/Free marker**.#  
- [.added]#Sorting options include **Newest first**, **Lowest price**, and **Condition rating**.#  
- [.added]#Each listing card shows **Title, Thumbnail, Price/Free marker, Condition, and Seller rating (if available)**.#  
- [.added]#Clicking a card opens **Listing Details**, where the **Contact Seller** button is visible if the viewer is not the owner.#

[.added]#*Saved Listings (Buyer View)*#
- [.added]#Buyers can **Save/Unsave** a listing from both the card and details views.#  
- [.added]#Saved items persist across sessions and appear in the **Saved Listings** section under the user menu.#  
- [.added]#Saved icons visually change state (e.g., outlined vs. filled heart).#  

[.added]#*Contact Seller / Messaging*#
- [.added]#**Contact Seller** opens a message composer prefilled with the listing title.#  
- [.added]#On send, show confirmation (“Message sent”) and add it to **Message Threads**.#  
- [.added]#Seller receives a **notification badge** in the header or inbox.#  
- [.added]#Messages are displayed chronologically, grouped by listing.#  

[.added]#*Profile & Reviews*#
- [.added]#Sellers and buyers each have a **profile page** displaying their listings, ratings, and reviews.#  
- [.added]#Users can **edit their own profile** (profile picture, bio, location).#  
- [.added]#Reviews are **read-only** for the profile owner but can be submitted by others after an offline exchange.#  
- [.added]#The **average rating** and total reviews are displayed prominently at the top of the profile.#

[.added]#*Accessibility & Feedback*#
- [.added]#All interactive elements are **keyboard-accessible** (Tab/Shift+Tab) with visible **focus outlines**.#  
- [.added]#Inline validation messages are **ARIA-live announced** to screen readers.#  
- [.added]#Toasts and banners are **non-blocking** and dismissible via keyboard.#  
- [.added]#Forms include descriptive labels and placeholder text for clarity.#

==== Examples

- [.removed]#**Initialization**: A seller lists a jacket. The system creates an item entity with attributes (ID=1001, seller=U123, category=outerwear, price=$50, status=available).#
- [.removed]#**Update**: A buyer purchases the jacket. The system updates the transaction status (T555: pending → confirmed), and the item status (I1001: available → sold).#
- [.removed]#**Restriction**: The seller attempts to change the price of the sold jacket. The system prevents this update because item availability = “sold.”#

1. [.added]#**Create Listing**: A seller opens the *Create Listing* form. Title is empty and there are no images, so **Publish** is disabled. The user enters a title, selects a category, and uploads a photo. **Publish** becomes active. On submit, a success toast appears and the app redirects to the Listing Details page.#  
2. [.added]#**Reserve Then Close**: A seller opens their Listing (Status = Active), selects **Reserved** from the dropdown. After completing the exchange offline, they select **Closed**, disabling all edit controls.#  
3. [.added]#**Contact Seller**: A buyer opens a listing and clicks **Contact Seller**, writes a message, and sends it. A confirmation appears, and the seller’s header shows a **1** notification badge.#

==== Relation to Domain Requirements
- [.changed]#Domain Requirements define what must exist (e.g., Listing entity, User, Saved association).#  
- [.changed]#Interface Requirements define how users **create, view, modify, and interact** with those entities through UI components.#  
- [.changed]#Each interface rule directly supports a domain rule by providing a visible, testable interaction.#  

==== Justification

[.removed]#These interface requirements ensure that the system remains synchronized with real-world buying and selling activities. Initialization rules prevent incomplete or invalid entities. Update rules enforce consistency and protect critical data (e.g., preventing edits to sold items or completed transactions).#

[.added]#This section ensures that UI behaviors are intuitive, consistent, and verifiable. It separates internal representation (domain) from what users experience, providing a clear mapping between actions and visible states. These behaviors reinforce trust and usability while aligning with accessibility and real-world discovery practices.#

==== Testing Plan

- [.removed]#Verify that all clothing items created by sellers initialize with complete required attributes.#
- [.removed]#Simulate purchase flows and confirm item and transaction entities update correctly (status changes).#
- [.removed]#Attempt restricted updates (e.g., editing sold items, altering completed transactions) and confirm the system rejects them.#
- [.added]#Test each form and button for proper enable/disable states and validation.#  
- [.added]#Confirm that “Publish” and “Close” actions trigger correct navigation and feedback messages.#  
- [.added]#Verify that saved listings persist across sessions.#  
- [.added]#Ensure that editing is disabled once a listing is closed.#  
- [.added]#Check accessibility by tab-navigating forms and validating screen reader output.#  
- [.added]#Confirm that notifications appear when a buyer sends a contact message.#
